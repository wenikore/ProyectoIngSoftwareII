<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/templates/principal.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <ui:define name="content">
        <div class="row tile_count">
            #{seguimientosVendedorVmb.clasificarSeguimientos()}
            <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
                <span class="count_top"><i class="fa fa-user"></i> Cita Presencial</span>
                <div class="count">#{seguimientosVendedorVmb.cita_Presencial}</div>

            </div>
            <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
                <span class="count_top"><i class="fa fa-clock-o"></i> Envio Informacion</span>
                <div class="count">#{seguimientosVendedorVmb.envio_Informacion}</div>

            </div>
            <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
                <span class="count_top"><i class="fa fa-user"></i> Contacto Telefonico</span>
                <div class="count green">#{seguimientosVendedorVmb.contacto_Telefonico}</div>

            </div>
            <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
                <span class="count_top"><i class="fa fa-user"></i> Cita Virtual</span>
                <div class="count">#{seguimientosVendedorVmb.cita_Virtual}</div>

            </div>
            <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
                <span class="count_top"><i class="fa fa-user"></i> Contacto Posterior</span>
                <div class="count">#{seguimientosVendedorVmb.contacto_Posterior}</div>

            </div>
            <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
                <span class="count_top"><i class="fa fa-user"></i> Otro</span>
                <div class="count">#{seguimientosVendedorVmb.otro}</div>

            </div>
        </div>


        <h:form>
            <p:growl autoUpdate="true" showDetail="true" showSummary="true"  globalOnly="true" for="messageId"></p:growl>
            <h:inputHidden id="messageId"></h:inputHidden>
        </h:form>

        <h:form>


            <div class="row">
                <div class="col-md-12 col-sm-12 col-xs-12">
                    <div class="dashboard_graph">

                        <div class="row x_title">
                            <div class="col-md-6">
                                <h3>Actividad en las campa침as <small> Estado de los clientes</small></h3>
                            </div>
                            <div class="col-md-6">
                                <div id="reportrange" class="pull-right" style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc">
                                    <i class="glyphicon glyphicon-calendar fa fa-calendar"></i>
                                    <span>December 30, 2014 - January 28, 2015</span> <b class="caret"></b>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-9 col-sm-9 col-xs-12">
                            <div id="chart_plot_01" class="demo-placeholder"></div>
                        </div>
                        <div class="col-md-3 col-sm-3 col-xs-12 bg-white">
                            <div class="x_title">
                                <h2>Clasificaci칩n de contactos</h2>
                                <div class="clearfix"></div>
                            </div>

                            <div class="col-md-12 col-sm-12 col-xs-6">
                                <div>
                                    <p>Campa침a Producto 1</p>
                                    <div class="">
                                        <div class="progress progress_sm" style="width: 76%;">
                                            <div class="progress-bar bg-green" role="progressbar" data-transitiongoal="80"></div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <p>Campa침a Producto 2</p>
                                    <div class="">
                                        <div class="progress progress_sm" style="width: 76%;">
                                            <div class="progress-bar bg-green" role="progressbar" data-transitiongoal="60"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>


                        </div>

                        <div class="clearfix"></div>
                    </div>
                </div>

            </div>
            <br />

            <div class="row">

                <div>
                    <div class="x_panel tile  overflow_hidden">
                        <div class="x_title">
                            <h2>Estados</h2>
                            <ul class="nav navbar-right panel_toolbox">
                                <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                                </li>
                                <li class="dropdown">
                                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                                    <ul class="dropdown-menu" role="menu">
                                        <li><a href="#">Configuracion</a>
                                        </li>

                                    </ul>
                                </li>
                                <li><a class="close-link"><i class="fa fa-close"></i></a>
                                </li>
                            </ul>
                            <div class="clearfix"></div>
                        </div>
                        <div class="x_content">
                            <table class="" style="width:100%">
                                <tr>
                                    <th style="width:70%;">
                                        <p>Grafica</p>
                                    </th>
                                    <th>

                                        <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5">
                                            <p>Valor Relativo</p>
                                        </div>
                                    </th>
                                </tr>
                                <tr>
                                    <td>
                                        <canvas id="myChart" class="canvasDoughnut" height="150" width="300" style="margin: 15px 10px 10px 0"></canvas>
                                    </td>
                                    <td>
                                        <table class="tile_info">
                                            <tr>
                                                <td>
                                                    <p><i class="fa fa-square blue"></i>Contacto Telefonico</p>
                                                </td>
                                                <td>#{(seguimientosVendedorVmb.contacto_Telefonico / seguimientosVendedorVmb.cantidadSeguimientos()) * 100}%</td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p><i class="fa fa-square green"></i>Cita Presencial</p>
                                                </td>
                                                <td>#{(seguimientosVendedorVmb.cita_Presencial / seguimientosVendedorVmb.cantidadSeguimientos()) * 100}%</td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p><i class="fa fa-square purple"></i>Cita Virtual</p>
                                                </td>
                                                <td>#{(seguimientosVendedorVmb.cita_Virtual / seguimientosVendedorVmb.cantidadSeguimientos()) * 100}%</td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p><i class="fa fa-square aero"></i>Contacto Posterior</p>
                                                </td>
                                                <td>#{(seguimientosVendedorVmb.contacto_Posterior / seguimientosVendedorVmb.cantidadSeguimientos()) * 100}%</td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p><i class="fa fa-square yellow"></i>Envio Informacion</p>
                                                </td>
                                                <td>#{(seguimientosVendedorVmb.envio_Informacion / seguimientosVendedorVmb.cantidadSeguimientos()) * 100}%</td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p><i class="fa fa-square red"></i>Otro</p>
                                                </td>
                                                <td>#{(seguimientosVendedorVmb.otro / seguimientosVendedorVmb.cantidadSeguimientos()) * 100}%</td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>



                <!-- Modal -->
                <div class="modal fade" id="myModal" role="dialog">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">

                            <div class="container">
                                <div class="row">
                                    <div class="col-md-8 col-md-offset-2 text-xs-center">
                                        <center><h3 style="color: #000000; margin-top: 10px" id="objetivo" class="mbr-section-title display-2"></h3></center>
                                        <div class="lead" style="text-align:center;">
                                            <p id="cantidad" style="color:#000000">

                                            </p>
                                            <table border="1" style="width: 100%" >
                                                <tr>
                                                    <td style="text-align: center; font-weight: bold; padding: 1em">
                                                        Nombre
                                                    </td>
                                                    <td style="text-align: center; font-weight: bold; padding: 1em">
                                                        Apellido
                                                    </td>
                                                    <td style="text-align: center; font-weight: bold; padding: 1em">
                                                        Telefono
                                                    </td>
                                                    <td style="text-align: center; font-weight: bold; padding: 1em">
                                                        Email
                                                    </td>

                                                </tr>
                                            </table>
                                            <table border="1" style="width: 100%" id="tbTest" >

                                                <tbody>
                                                    <tr>

                                                    </tr>

                                                </tbody>
                                                <div id="prueba"></div>
                                            </table>
                                        </div>
                                    </div>

                                </div>

                            </div>
                            <div class="modal-footer">
                                <button id="btn_modal" type="button" class="btn btn-warning" data-dismiss="modal">Cerrar</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modal -->
            </div>




            <script src="../resources/js/jquery.min.js"></script>
            <script src="../resources/js/fastclick.js"></script>

            <script src="../resources/js/nprogress.js"></script>


            <script src="../resources/js/Chart.min.js"></script>

            <script src="../resources/js/gauge.min.js"></script>

            <script src="../resources/js/bootstrap-progressbar.min.js"></script>

            <script src="../resources/js/icheck.min.js"></script>

            <script src="../resources/js/skycons.js"></script>

            <script src="../resources/js/jquery.flot.js"></script>
            <script src="../resources/js/jquery.flot.pie.js"></script>
            <script src="../resources/js/jquery.flot.time.js"></script>
            <script src="../resources/js/Flot/jquery.flot.stack.js"></script>
            <script src="../resources/js/jquery.flot.resize.js"></script>

            <script src="../resources/js/jquery.flot.orderBars.js"></script>
            <script src="../resources/js/jquery.flot.spline.min.js"></script>
            <script src="../resources/js/curvedLines.js"></script>

            <script src="../resources/js/date.js"></script>

            <script src="../resources/js/jquery.vmap.js"></script>
            <script src="../resources/js/jquery.vmap.world.js"></script>
            <script src="../resources/js/jquery.vmap.sampledata.js"></script>

            <script src="../resources/js/moment.min.js"></script>
            <script src="../resources/js/daterangepicker.js"></script>
            <script>
//                console.log("#{seguimientosVendedorVmb.cantidadSeguimientos()}");
//                console.log("cita_Presencial "+"#{seguimientosVendedorVmb.cita_Presencial}");
//                console.log("cita_Virtual "+"#{seguimientosVendedorVmb.cita_Virtual}");
//                console.log("contacto_Posterior "+"#{seguimientosVendedorVmb.contacto_Posterior}");
//                console.log("contacto_Telefonico "+ "#{seguimientosVendedorVmb.contacto_Telefonico}");
//                console.log("envio_Informacion "+"#{seguimientosVendedorVmb.envio_Informacion}");
//                console.log("otro "+ "#{seguimientosVendedorVmb.otro}");

                var data = {
                    datasets: [{
                            data: [#{seguimientosVendedorVmb.contacto_Posterior},
                #{seguimientosVendedorVmb.cita_Virtual},
                #{seguimientosVendedorVmb.otro},
                #{seguimientosVendedorVmb.cita_Presencial},
                #{seguimientosVendedorVmb.contacto_Telefonico},
                #{seguimientosVendedorVmb.envio_Informacion}],
                            backgroundColor: [
                                "#BDC3C7",
                                "#9B59B6",
                                "#E74C3C",
                                "#26B99A",
                                "#3498DB",
                                "#6C6C6C"]
                        }],
                    labels: [
                        "Contacto Posterior",
                        "Cita Virtual",
                        "Otro",
                        "Cita Presencial",
                        "Contacto Telefonico",
                        "Envio Informacion"]
                }
                ;
                $(document).ready(
                        function () {

                            $("#btn_modal").click(function (event) {
                                $("#tbTest").empty();
                                $("#tbTest").append("<tr></tr>");
                            });
                            var canvas = document.getElementById("myChart");
                            var ctx = canvas.getContext("2d");
                            var myNewChart = new Chart(ctx, {
                                type: 'doughnut',
                                data: data
                            });
                            canvas.onclick = function (evt) {
                                var activePoints = myNewChart.getElementsAtEvent(evt);
                                var chartData = activePoints[0]['_chart'].config.data;
                                var idx = activePoints[0]['_index'];
                                var etiqueta = chartData.labels[idx];
                                var valor = chartData.datasets[0].data[idx];
                                if (etiqueta == "Contacto Posterior") {
                                    var ListaContacto_Posterior = "#{seguimientosVendedorVmb.listaContacto_posterior}".split("*");
                                    $.each(ListaContacto_Posterior, function (key, value) {
                                        if (value != "") {
                                            var aux = value.split("-");
                                            $('#tbTest tr:last').after('<tr><td>' + aux[0] + '</td><td>' + aux[1] + '</td><td>' + aux[2] + '</td><td>' + aux[3] + '</td></tr>');
                                        }
                                    });
                                }
                                if (etiqueta == "Cita Virtual") {
                                    var ListaContacto_Posterior = "#{seguimientosVendedorVmb.listaCita_virtual}".split("*");
                                    $.each(ListaContacto_Posterior, function (key, value) {
                                        if (value != "") {
                                            var aux = value.split("-");
                                            $('#tbTest tr:last').after('<tr><td>' + aux[0] + '</td><td>' + aux[1] + '</td><td>' + aux[2] + '</td><td>' + aux[3] + '</td></tr>');
                                        }
                                    });
                                }
                                if (etiqueta == "Otro") {
                                    var ListaContacto_Posterior = "#{seguimientosVendedorVmb.listaOtro}".split("*");
                                    $.each(ListaContacto_Posterior, function (key, value) {
                                        if (value != "") {
                                            var aux = value.split("-");
                                            $('#tbTest tr:last').after('<tr><td>' + aux[0] + '</td><td>' + aux[1] + '</td><td>' + aux[2] + '</td><td>' + aux[3] + '</td></tr>');
                                        }
                                    });
                                }
                                if (etiqueta == "Cita Presencial") {
                                    var ListaContacto_Posterior = "#{seguimientosVendedorVmb.listaCita_Presencial}".split("*");
                                    $.each(ListaContacto_Posterior, function (key, value) {
                                        if (value != "") {
                                            var aux = value.split("-");
                                            $('#tbTest tr:last').after('<tr><td>' + aux[0] + '</td><td>' + aux[1] + '</td><td>' + aux[2] + '</td><td>' + aux[3] + '</td></tr>');
                                        }
                                    });
                                }
                                if (etiqueta == "Contacto Telefonico") {
                                    var ListaContacto_Posterior = "#{seguimientosVendedorVmb.listaContacto_telefonico}".split("*");
                                    $.each(ListaContacto_Posterior, function (key, value) {
                                        if (value != "") {
                                            var aux = value.split("-");
                                            $('#tbTest tr:last').after('<tr><td>' + aux[0] + '</td><td>' + aux[1] + '</td><td>' + aux[2] + '</td><td>' + aux[3] + '</td></tr>');
                                        }
                                    });
                                }
                                if (etiqueta == "Envio Informacion") {
                                    var ListaContacto_Posterior = "#{seguimientosVendedorVmb.listaEnvio_Informacion}".split("*");
                                    $.each(ListaContacto_Posterior, function (key, value) {
                                        if (value != "") {
                                            var aux = value.split("-");
                                            $('#tbTest tr:last').after('<tr><td>' + aux[0] + '</td><td>' + aux[1] + '</td><td>' + aux[2] + '</td><td>' + aux[3] + '</td></tr>');
                                        }
                                    });
                                }
                                $("#objetivo").text(etiqueta);
                                $("#cantidad").text("Se encontraron "+ valor +" contactos en estado "+etiqueta);
                                $('#myModal').modal('show')
                            };
                        }

                );
//                

            </script>
        </h:form> 

    </ui:define>
</ui:composition>